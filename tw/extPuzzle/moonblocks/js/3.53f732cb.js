(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"03d8":function(t,e,a){},"1a67":function(t,e,a){t.exports=a.p+"img/role02.382f1e9e.webp"},"1f70":function(t,e,a){t.exports=a.p+"img/flat.a63a1f2f.webp"},"78c6":function(t,e,a){t.exports=a.p+"img/role03.1eae5459.webp"},b6e4:function(t,e,a){"use strict";a("03d8")},cf86:function(t,e,a){"use strict";a.r(e),a("0481"),a("4069");var s=function(){var t=this,e=t._self._c;return e("div",{ref:"moonblocks",staticClass:"moonblocksWrap",class:{depthFx:t.isOpenAlertModel}},[t.finalBlocks?e("div",{staticClass:"finalBlocks",class:{"text-orange-8":"聖筊"==t.finalBlocks,"text-grey-7":"笑筊"==t.finalBlocks,"text-blue-9":"陰筊"==t.finalBlocks}},[t._v("\n    "+t._s(t.finalBlocks)+"\n  ")]):t._e(),e("div",{staticClass:"instruct",on:{mouseup:function(e){return"button"in e&&1!==e.button?null:t.setResult.apply(null,arguments)}}},[e("div",{staticClass:"instruct-main row"},[e("div",{staticClass:"score dark"},[t._v("1")]),e("div",{staticClass:"score q-mx-xs gold"},[t._v("5")]),e("div",{staticClass:"score red"},[t._v("15")]),e("q-space"),t._l(t.consecutiveSaint||0,function(t){return e("q-icon",{key:"s-".concat(t),staticClass:"q-mx-xs",attrs:{name:"fas fa-star",color:"orange-8",size:"sm"}})}),t._l(3-t.consecutiveSaint||0,function(t){return e("q-icon",{key:"se-".concat(t),staticClass:"q-mx-xs",attrs:{name:"far fa-star",color:"orange-4",size:"sm"}})})],2)]),e("div",{ref:"stage",staticClass:"stage"},[e("div",{ref:"stack",staticClass:"stack"},t._l(3,function(a){return e("div",{key:"stack"+a,ref:function(e){return t.stackPieces[a-1]=e},refInFor:!0,staticClass:"piece"},[e("div",{staticClass:"face front"},[e("img",{attrs:{src:t.useImage.curve,alt:"凸面"}})]),e("div",{staticClass:"face back"},[e("img",{attrs:{src:t.useImage.flat,alt:"平面"}})])])}),0),e("div",{ref:"leftPiece",staticClass:"piece left"},[e("div",{staticClass:"face front"},[e("img",{attrs:{src:t.useImage.curve,alt:"凸面"}})]),e("div",{staticClass:"face back"},[e("img",{attrs:{src:t.useImage.flat,alt:"平面"}})])]),e("div",{ref:"rightPiece",staticClass:"piece right"},[e("div",{staticClass:"face front"},[e("img",{attrs:{src:t.useImage.curve,alt:"凸面"}})]),e("div",{staticClass:"face back"},[e("img",{attrs:{src:t.useImage.flat,alt:"平面"}})])])]),e("div",{ref:"scoreHint",staticClass:"score-hint"}),e("div",{staticStyle:{height:"50px",width:"90vw"}},[e("div",{staticClass:"timing-bar"},[e("div",{staticClass:"segments",attrs:{"aria-hidden":"true"}}),e("div",{ref:"ghostLayer",staticClass:"ghost-layer"}),e("div",{ref:"marker",staticClass:"marker"})])]),e("div",{staticStyle:{width:"90vw"}},[e("q-card-section",{attrs:{horizontal:""}},[e("q-card-section",{staticClass:"q-pa-none"},[e("q-linear-progress",{staticClass:"vertical-progress",attrs:{stripe:"",rounded:"",value:t.progress,color:"orange","track-color":"grey-5"}},[e("div",{staticClass:"absolute-full flex flex-center"},[e("q-badge",{staticClass:"progress-badge",attrs:{color:"white","text-color":"accent"}},[t._v("\n              "+t._s(t.progressLabel)+"\n            ")])],1)])],1),e("q-separator",{attrs:{vertical:"",spaced:""}}),e("q-card-section",{staticClass:"full-width q-pa-none"},[t.isShowRoleSpeakBtn?e("q-btn",{staticClass:"q-py-sm full-width",staticStyle:{"touch-action":"manipulation"},attrs:{color:"dark",outline:"",ripple:!1},on:{click:t.showRoleSpeak}},[e("div",{staticClass:"flex flex-center"},[e("span",{staticClass:"text-h5"},[t._v(t._s(t.currentLangPack.ui.resultBtn))])])]):e("q-btn",{staticClass:"q-py-sm full-width",staticStyle:{"touch-action":"manipulation"},attrs:{color:"black","text-color":"white",unelevated:"",disable:t.isThrowing},on:{click:t.throwMoonblocks}},[e("div",{staticClass:"flex flex-center"},[e("q-icon",{attrs:{size:"28px",name:"fas fa-praying-hands"}}),e("span",{staticClass:"text-h5 q-ml-md"},[t._v(t._s(t.currentLangPack.ui.throwBtn))])],1)])],1)],1)],1),e("q-dialog",{attrs:{persistent:"",maximized:"",position:"bottom","transition-show":"fade","transition-hide":"fade"},model:{value:t.isOpenAlertModel,callback:function(e){t.isOpenAlertModel=e},expression:"isOpenAlertModel"}},[e("q-card",{staticClass:"transparent roleSpeakCard",class:{isImgOK:t.isImgOk},attrs:{flat:""}},[1==t.alertState?e("q-card-section",{staticClass:"text-h8 q-py-none"},[e("div",{staticClass:"resImg"},[e("div",{staticClass:"text-center"},[e("div",{staticClass:"gameCluesCard"},[e("div",{staticClass:"speech-bubble"},[1==t.consecutiveSaint?e("div",{staticClass:"describe"},[e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.first.a))]),e("span",{staticClass:"text-h5 text-fwb",staticStyle:{color:"#d4af37"}},[t._v("\n                      "+t._s(t.finalBlocks)+"\n                    ")]),e("span",[t._v(t._s(t.currentLangPack.sacred.first.b))])]),e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.first.c))])])]):t._e(),2==t.consecutiveSaint?e("div",{staticClass:"describe"},[e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.second.a))]),e("span",{staticClass:"text-h5 text-fwb",staticStyle:{color:"#d4af37"}},[t._v("\n                      "+t._s(t.finalBlocks)+"\n                    ")]),e("span",[t._v(t._s(t.currentLangPack.sacred.second.b))])]),e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.second.c))])])]):t._e(),3==t.consecutiveSaint?e("div",{staticClass:"describe"},[e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.third.a))]),e("span",{staticClass:"text-h5 text-fwb",staticStyle:{color:"#d4af37"}},[t._v("\n                      "+t._s(t.finalBlocks)+"\n                    ")]),e("span",[t._v(t._s(t.currentLangPack.sacred.third.b))])]),e("div",[e("span",[t._v(t._s(t.currentLangPack.sacred.third.c))])])]):t._e(),e("div",{staticClass:"full-width q-mt-md row"},[e("q-space"),e("q-btn",{attrs:{flat:"",label:t.currentLangPack.ui.next,color:"blue",size:"18px",unelevated:""},on:{click:t.closeAlertModel}})],1)])]),e("q-img",{staticClass:"q-ml-xl",staticStyle:{width:"90%"},attrs:{src:t.useImage.roleOne,"no-default-spinner":"",basic:""},on:{load:t.onImgLoading}})],1)])]):t._e(),2==t.alertState?e("q-card-section",{staticClass:"text-h8 q-py-none"},[e("div",{staticClass:"resImg"},[e("div",{staticClass:"text-center"},[e("div",{staticClass:"gameCluesCard"},[e("div",{staticClass:"speech-bubble"},[e("div",{staticClass:"describe"},[e("div",[e("span",[t._v(t._s(t.currentLangPack.laughing.a))]),e("span",{staticClass:"text-grey-7 text-h5 text-fwb"},[t._v(t._s(t.finalBlocks))]),e("span",[t._v(t._s(t.currentLangPack.laughing.b))])]),e("div",[e("span",[t._v(t._s(t.currentLangPack.laughing.c))])]),e("div",{staticClass:"full-width q-mt-md row"},[e("q-space"),e("q-btn",{attrs:{flat:"",label:t.currentLangPack.ui.restart,color:"blue",size:"18px",unelevated:""},on:{click:t.closeAlertModel}})],1)])])]),e("q-img",{staticClass:"q-ml-xl",staticStyle:{width:"90%"},attrs:{src:t.useImage.roleTwo,"no-default-spinner":"",basic:""},on:{load:t.onImgLoading}})],1)])]):t._e(),3==t.alertState?e("q-card-section",{staticClass:"text-h8 q-py-none"},[e("div",{staticClass:"resImg"},[e("div",{staticClass:"text-center"},[e("div",{staticClass:"gameCluesCard"},[e("div",{staticClass:"speech-bubble"},[e("div",{staticClass:"describe"},[e("div",[e("span",[t._v(t._s(t.currentLangPack.negative.a))]),e("span",{staticClass:"text-blue-9 text-h5 text-fwb"},[t._v(t._s(t.finalBlocks))]),e("span",[t._v(t._s(t.currentLangPack.negative.b))])]),e("div",[e("span",[t._v(t._s(t.currentLangPack.negative.c))])]),e("div",{staticClass:"full-width q-mt-md row"},[e("q-space"),e("q-btn",{attrs:{flat:"",label:t.currentLangPack.ui.restart,color:"blue",size:"18px",unelevated:""},on:{click:t.closeAlertModel}})],1)])])]),e("q-img",{staticClass:"q-ml-xl",staticStyle:{width:"90%"},attrs:{src:t.useImage.roleThree,"no-default-spinner":"",basic:""},on:{load:t.onImgLoading}})],1)])]):t._e()],1)],1),e("section",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e("img",{attrs:{src:t.useImage.roleOne}}),e("img",{attrs:{src:t.useImage.roleTwo}}),e("img",{attrs:{src:t.useImage.roleThree}})])],1)},r=[],i=a("7ec2"),n=a.n(i),c=a("c973"),o=a.n(c),l=(a("99af"),a("caad"),a("e260"),a("14d9"),a("b680"),a("d3b7"),a("e6cf"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),{name:"moonblocks",data:function(){return{isThrowing:!1,finalBlocks:"",stackPieces:[],markerPos:0,markerSpeed:2,markerDirection:1,animFrame:null,pressCount:0,totalScore:0,scoreLog:[],ghostTimers:[],showUI:!0,showRestartBtn:!1,consecutiveSaint:0,isOpenAlertModel:!1,alertState:null,isShowRoleSpeakBtn:!1,isImgOk:!1}},computed:{progress:function(){var t=this.totalScore;return t/150},progressLabel:function(){var t="".concat((100*this.progress).toFixed(0)," %");return t},currentLangPack:function(){var t=window.location.hash.toLowerCase(),e={sacred:{first:{a:"唷～是",b:"，這開局不錯嘛！",c:"看來觀音姐姐今天心情不錯喔～♪"},second:{a:"哇啊！連二次",b:"耶！？",c:"嘿嘿，我感覺這肯定有戲～！"},third:{a:"喔喔喔",b:"三連發！！！",c:"看來這支籤就是菩薩的指示啦～～！"}},laughing:{a:"欸？",b:"......？",c:"是要我想清楚再問的意思嗎...？"},negative:{a:"蛤？",b:"？靠！被打槍了啦......",c:"唉！換個方式再問一次好了......"},ui:{throwBtn:"稟告神明",resultBtn:"結果確認",next:"繼續",restart:"重新開始"}},a={sacred:{first:{a:"",b:"じゃん！こりゃ幸先いいねぇ",c:"観音姐さん、今日は機嫌がいいみたいだな〜〜♪"},second:{a:"二回連続で",b:"じゃん！？",c:"これはきっとうまくいくでしょう～！"},third:{a:"",b:"が三連発だーーー！！！",c:"こりゃあ、この籤こそ観音姐さんのご指示ってやつだな〜〜！"}},laughing:{a:"えっ？",b:"......？",c:"ってことは、「ちゃんと考えてから聞け」って意味なのか……？"},negative:{a:"はぁ？",b:"！？ ちょっ……マジかよ、フラれた……！",c:"はぁ〜〜、しょうがねぇ……もう一回聞き方を変えるか……。"},ui:{throwBtn:"神様に祈願",resultBtn:"結果確認",next:"続ける",restart:"再開する"}},s=t.includes("jp");return s?a:e},useImage:function(){return{roleOne:a("ea5d"),roleTwo:a("1a67"),roleThree:a("78c6"),curve:a("f011"),flat:a("1f70")}}},mounted:function(){this.startMarker()},beforeUnmount:function(){this.animFrame&&cancelAnimationFrame(this.animFrame),this.ghostTimers.forEach(function(t){return clearTimeout(t)})},methods:{setResult:function(){var t={type:"customAns"};parent.postMessage(t,location.origin)},startMarker:function(){var t=this;this.stopMarker(),this.lastTime=performance.now();var e=function e(a){var s=(a-t.lastTime)/16.67;t.lastTime=a,t.markerPos+=t.markerSpeed*s*t.markerDirection,t.markerPos>=100?(t.markerPos=100,t.markerDirection=-1):t.markerPos<=0&&(t.markerPos=0,t.markerDirection=1),t.$refs.marker&&(t.$refs.marker.style.left="".concat(t.markerPos/100*100,"%")),t.animFrame=requestAnimationFrame(e)};this.animFrame=requestAnimationFrame(e)},stopMarker:function(){return this.animFrame&&(cancelAnimationFrame(this.animFrame),this.animFrame=null),this.markerPos},getScoreFromValue:function(t){var e=Math.round(t);return e>=1&&e<=30?1:e>=31&&e<=45?5:e>=46&&e<=55?15:e>=56&&e<=70?5:1},mapFaces:function(t){switch(t){case"聖筊":return Math.random()<.5?[!0,!1]:[!1,!0];case"陰筊":return[!1,!1];case"笑筊":return[!0,!0]}},throwMoonblocks:function(){var t=this;return o()(n()().mark(function e(){var a,s,r,i,c,o,l,d,u;return n()().wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isThrowing){e.next=2;break}return e.abrupt("return");case 2:if(t.isThrowing=!0,a=3,s=Math.max(0,t.markerPos-a),r=Math.min(100,s),i=t.getScoreFromValue(r),t.spawnGhost(r),t.spawnScoreHint(r,i),t.pressCount+=1,t.totalScore+=i,t.scoreLog.push(i),t.markerSpeed=Math.min(t.markerSpeed+.4,5),!(t.pressCount<10)){e.next=16;break}return t.isThrowing=!1,e.abrupt("return");case 16:c=t.markerPos,o=Math.min(100,Math.max(0,c+20*t.markerDirection)),l=2e3,t.evaluateResult(),d=performance.now(),u=function e(a){var s=Math.min((a-d)/l,1),r=1-Math.pow(1-s,3);t.markerPos=c+(o-c)*r,t.$refs.marker&&(t.$refs.marker.style.left="".concat(t.markerPos,"%")),s<1?requestAnimationFrame(e):t.stopMarker()},requestAnimationFrame(u);case 23:case"end":return e.stop()}},e)}))()},evaluateResult:function(){var t,e=this,a=this.totalScore/150*100,s=a,r=100*Math.random();t=r<s?"聖筊":Math.random()<.5?"陰筊":"笑筊";var i=this.$refs.stack,n=this.$refs.leftPiece,c=this.$refs.rightPiece;[n,c].forEach(function(t){t.style.display="none",t.style.opacity=1}),i.style.animation="none",i.style.opacity=1,i.style.display="none";var o=this.mapFaces(t);n.style.display=c.style.display="block";var l=o[0]?0:180,d=o[1]?0:180,u=50*Math.random()-20-220,f=50*Math.random()-20+220,m=n.animate([{transform:"translate(calc(50% - 60px), 0px) rotateY(0deg) rotateZ(0deg)"},{transform:"translate(calc(20% - 60px), 50px) rotateY(540deg) rotateZ(-200deg)"},{transform:"translate(calc(20% - 60px), 200px) rotateY(".concat(l,"deg) rotateZ(-240deg)")}],{duration:800,easing:"linear",fill:"forwards"}),h=c.animate([{transform:"translate(calc(50% - 60px), 0px) rotateY(0deg) rotateZ(0deg)"},{transform:"translate(calc(80% - 60px), 40px) rotateY(540deg) rotateZ(200deg)"},{transform:"translate(calc(80% - 60px), 200px) rotateY(".concat(d,"deg) rotateZ(240deg)")}],{duration:820,easing:"linear",fill:"forwards"});this.showUI=!1,Promise.all([m.finished,h.finished]).then(function(){n.animate([{transform:"translate(calc(20% - 60px), 200px) rotateY(".concat(l,"deg) rotateZ(-240deg)")},{transform:"translate(calc(15% - 60px), 160px) rotateY(".concat(l,"deg) rotateZ(-260deg)")},{transform:"translate(calc(10% - 60px), 200px) rotateY(".concat(l,"deg) rotateZ(").concat(u,"deg)")}],{duration:700,easing:"cubic-bezier(.2,.8,.3,1)",fill:"forwards"}),c.animate([{transform:"translate(calc(80% - 60px), 200px) rotateY(".concat(d,"deg) rotateZ(240deg)")},{transform:"translate(calc(85% - 60px), 160px) rotateY(".concat(d,"deg) rotateZ(260deg)")},{transform:"translate(calc(90% - 60px), 200px) rotateY(".concat(d,"deg) rotateZ(").concat(f,"deg)")}],{duration:700,easing:"cubic-bezier(.2,.8,.3,1)",fill:"forwards"}),e.finalBlocks=t,e.isShowRoleSpeakBtn=!0,"聖筊"===e.finalBlocks?e.consecutiveSaint+=1:e.consecutiveSaint=0})},showRoleSpeak:function(){"聖筊"===this.finalBlocks?this.openAlertModel(1):"笑筊"===this.finalBlocks?this.openAlertModel(2):this.openAlertModel(3)},spawnGhost:function(t){var e=Math.min(100,Math.max(0,t)),a=this.$refs.ghostLayer;if(a){var s=document.createElement("div");s.className="ghost theme-temple",s.style.left="".concat(e,"%"),a.appendChild(s),requestAnimationFrame(function(){s.style.opacity="0"});var r=setTimeout(function(){s.remove()},1e3);this.ghostTimers.push(r)}},spawnScoreHint:function(t,e){var a=Math.min(100,Math.max(0,t)),s=this.$refs.scoreHint;if(s){var r=document.createElement("div");r.className="score-float",r.textContent="+".concat(e),r.style.left="".concat(a,"%"),s.appendChild(r),requestAnimationFrame(function(){r.style.opacity="0",r.style.transform="translate(-50%, -20px)"}),setTimeout(function(){r.remove()},1e3)}},restartRound:function(){this.consecutiveSaint=0,this.pressCount=0,this.totalScore=0,this.scoreLog=[],this.markerSpeed=2,this.finalBlocks="",this.$refs.ghostLayer.innerHTML="",this.$refs.scoreHint.innerHTML="";var t=this.$refs.leftPiece,e=this.$refs.rightPiece,a=this.$refs.stack;[t,e].forEach(function(t){t.style.display="none",t.style.opacity=1,t.style.transform="translate(calc(50% - 60px), 0px) rotateY(0deg) rotateZ(0deg)"}),a.style.display="block",a.style.opacity=1,this.resetPieces(),this.showUI=!0,this.showRestartBtn=!1,this.startMarker()},resetPieces:function(){var t=this.$refs.leftPiece,e=this.$refs.rightPiece,a=this.$refs.stack;[t,e].forEach(function(t){t.style.display="none",t.style.opacity=1,t.style.transform="translate(calc(50% - 60px), 0px) rotateY(0deg) rotateZ(0deg)"}),a.style.display="block",a.style.opacity=1},startNextRound:function(){this.pressCount=0,this.totalScore=0,this.scoreLog=[],this.markerSpeed=2,this.$refs.ghostLayer.innerHTML="",this.$refs.scoreHint.innerHTML="",this.resetPieces(),this.showRestartBtn=!1,this.showUI=!0,this.startMarker()},openAlertModel:function(t){this.isOpenAlertModel=!0,this.alertState=t},closeAlertModel:function(){"聖筊"==this.finalBlocks&&(1==this.consecutiveSaint&&this.startNextRound(),2==this.consecutiveSaint&&this.startNextRound(),3==this.consecutiveSaint&&this.setResult()),"笑筊"==this.finalBlocks&&this.restartRound(),"陰筊"==this.finalBlocks&&this.restartRound(),this.isImgOk=!1,this.isThrowing=!1,this.isOpenAlertModel=!1,this.isShowRoleSpeakBtn=!1,this.finalBlocks=""},onImgLoading:function(){this.isImgOk=!0}}}),d=l,u=(a("b6e4"),a("2877")),f=a("2c91"),m=a("0016"),h=a("a370"),p=a("6b1d"),g=a("58a81"),v=a("eb85"),k=a("9c40"),b=a("24e8"),x=a("f09f"),C=a("068f"),w=a("eebe"),y=a.n(w),_=Object(u["a"])(d,s,r,!1,null,"512e4d16",null);e["default"]=_.exports,y()(_,"components",{QSpace:f["a"],QIcon:m["a"],QCardSection:h["a"],QLinearProgress:p["a"],QBadge:g["a"],QSeparator:v["a"],QBtn:k["a"],QDialog:b["a"],QCard:x["a"],QImg:C["a"]})},ea5d:function(t,e,a){t.exports=a.p+"img/role01.d5667b13.webp"},f011:function(t,e,a){t.exports=a.p+"img/curve.b88bf3bb.webp"}}]);