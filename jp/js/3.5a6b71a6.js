(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"2b9f":function(t,e,a){"use strict";a("e6c7")},4961:function(t,e,a){"use strict";a.r(e);a("b0c0");var s=function(){var t=this,e=t._self._c;return e("q-page",[t.taskShow?e("div",{staticClass:"col q-pb-xl"},[e("q-card",{staticClass:"q-mt-md"},[e("q-img",{staticStyle:{"min-height":"236px"},attrs:{src:t.taskData.taskPhoto}},[t.isGameEnd?e("div",{staticClass:"absolute-full text-h4 flex flex-center"},[t._v("\n          《 已通關 》\n        ")]):t._e()]),e("playStatus",{attrs:{taskData:t.taskData,isGameEnd:t.isGameEnd,gameEndInfo:t.gameEndInfo,facetrackInfo:t.facetrackInfo,score:t.score,planSpee:t.planSpee,playNotes:t.playNotes,playerStartTime:t.playerStartTime},on:{resetTask:t.resetTask,leaveTask:t.leaveTask,openViewTrt:t.openViewTrt,openScoreReward:function(e){t.poupSwch.scoreRewardModel=!0},openPlayfeedback:t.goPlayfeedbackQues}})],1),t.taskData.projectUnit?e("q-card",{staticClass:"q-py-sm q-pb-sm q-mt-md"},[e("q-list",{staticStyle:{"font-size":"16px"},attrs:{dense:""}},[e("q-item",{attrs:{clickable:""},on:{click:t.openUserWeb}},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{attrs:{size:"xl",rounded:""}},[e("img",{attrs:{src:"".concat(t.taskData.projectUnit.photo)}})])],1),e("q-item-section",[e("q-item-label",[t._v(t._s(t.taskData.projectUnit.name))]),e("q-item-label",{attrs:{caption:""}},[t._v("\n              "+t._s(t.taskData.projectUnit.desc||"尚無簡介內容")+"\n            ")])],1)],1),e("q-badge",{attrs:{color:"blue-grey-9",floating:""}},[t._v(" "+t._s(t.$t("gameDesign")))])],1)],1):t._e()],1):t._e(),e("section",[e("q-dialog",{attrs:{persistent:""},model:{value:t.poupSwch.scoreRewardModel,callback:function(e){t.$set(t.poupSwch,"scoreRewardModel",e)},expression:"poupSwch.scoreRewardModel"}},[e("q-card",{staticClass:"bg-grey-3",staticStyle:{width:"100%"}},[e("section",{staticClass:"bg-blue-grey-10 text-white row items-center q-pa-xs"},[e("span",{staticClass:"text-h6 q-ml-sm"},[t._v("\n            "+t._s(t.$t("pointsExchangeItems"))+"\n          ")]),e("q-space"),e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.poupSwch.scoreRewardModel=!1}}})],1),e("q-card-section",[e("q-list",t._l(t.taskData.scoreReward,function(a){return e("q-item",{key:a.scoreRewardSN,staticClass:"q-mx-sm q-my-md bg-white shadow-2",attrs:{clickable:t.score>=a.rewardPrice},on:{click:function(e){return t.exchange(a)}}},[e("q-item-section",{staticStyle:{"font-size":"18px"}},[e("q-item-label",[a.rewardContent?e("div",[a.rewardContent.propsLock?e("span",{staticClass:"text-red-10"},[t._v("\n                      "+t._s(t.$t("unknownItem"))+"\n                    ")]):e("span",{staticClass:"text-blue-10"},[t._v("\n                      "+t._s(a.rewardName)+"\n                    ")])]):t._e()]),e("q-item-label",{staticClass:"ellipsis-2-lines",attrs:{caption:""}},[a.rewardContent?e("div",[a.rewardContent.propsLock?e("span",[t._v("\n                      "+t._s(t.$t("GmaskText13"))+"\n                    ")]):e("span",[t._v(t._s(a.rewardDesc))])]):t._e()])],1),e("q-item-section",{attrs:{side:""}},[e("div",[e("span",{staticClass:"text-blue text-h6"},[t._v("\n                    "+t._s(a.rewardPrice)+"\n                  ")]),e("span",[t._v(t._s(t.$t("points")))])])]),e("q-badge",{attrs:{color:t.score>=a.rewardPrice?"light-blue-8":"red",floating:""}},[t.score>=a.rewardPrice?e("span",[t._v("\n                  "+t._s(t.$t("redeemable"))+"\n                ")]):e("span",[t._v(t._s(t.$t("insufficientPoints")))])])],1)}),1),t.noReward?e("div",{staticClass:"text-center q-my-xl text-h6 text-grey-7"},[t._v("\n            "+t._s(t.$t("noItemsToExchange"))+"\n          ")]):t._e()],1)],1)],1)],1),e("startTrtView",{attrs:{prompt:t.poupSwch.isCanViewTrt},on:{close:t.closeModel}}),e("q-dialog",{attrs:{maximized:"",persistent:"","transition-show":"none","transition-hide":"none"},model:{value:t.poupSwch.playfeedback,callback:function(e){t.$set(t.poupSwch,"playfeedback",e)},expression:"poupSwch.playfeedback"}},[e("div",{staticClass:"fit flex flex-center"},[e("q-card",{staticClass:"q-ma-lg transparent"},[e("q-card-section",{staticClass:"text-white"},[e("p",{staticClass:"text-h4 text-center q-mb-lg"},[t._v(t._s(t.$t("congrats")))]),e("p",{staticClass:"text-h7"},[t._v("\n            "+t._s(t.$t("feedbackText"))+"\n          ")])]),e("q-separator"),e("q-card-section",{staticClass:"row q-col-gutter-sm q-pa-sm"},[e("div",{staticClass:"col-12"},[e("q-btn",{staticClass:"full-width",attrs:{label:t.$t("waitWrite"),unelevated:"",size:"16px",color:"red-9"},on:{click:function(e){t.poupSwch.playfeedback=!1}}})],1),e("div",{staticClass:"col-12"},[e("q-btn",{staticClass:"full-width",attrs:{label:t.$t("noProb"),unelevated:"",size:"16px",color:"blue"},on:{click:t.goPlayfeedbackQues}})],1)])],1)],1)])],1)},n=[],o=a("398e"),r=a.n(o),i=a("c973"),c=a.n(i),l=a("ded3"),d=a.n(l),p=(a("99af"),a("14d9"),a("e9f5"),a("7d54"),a("b64b"),a("d3b7"),a("9911"),a("159b"),a("2f62")),f=a("b06b"),u=a("fd9b"),h=function(){var t=this,e=t._self._c;return e("q-card",{attrs:{flat:"",bordered:""}},[e("q-tabs",{staticClass:"bg-blue-grey-10 text-white",attrs:{"inline-label":"",dense:""},model:{value:t.statusTab,callback:function(e){t.statusTab=e},expression:"statusTab"}},[t.isGameEnd?e("q-tab",{attrs:{name:"achv",label:t.$t("achievement")}}):t._e(),e("q-tab",{attrs:{name:"desc",label:t.$t("activityDesc")}}),e("q-tab",{attrs:{name:"info",label:t.$t("basicInfo")}}),t.playNotes.length>0?e("q-tab",{attrs:{name:"notes",label:t.$t("travelNotes")}}):t._e()],1),e("q-separator"),e("q-tab-panels",{model:{value:t.statusTab,callback:function(e){t.statusTab=e},expression:"statusTab"}},[e("q-tab-panel",{attrs:{name:"info"}},[e("q-list",{staticStyle:{"font-size":"16px"},attrs:{separator:""}},[t.isGameEnd?t._e():[0!==t.score&&3!==t.taskData.projectType?e("q-item",[e("q-item-section",[e("q-item-label",[t._v(t._s(t.$t("currentPoints"))+"：")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[e("span",{staticClass:"q-mx-md"},[t._v(t._s(t.score))]),e("span",[t._v(t._s(t.$t("score")))])])],1)],1):t._e(),t.taskData.progState?e("q-item",{staticClass:"q-pt-md q-px-none q-pb-xs"},[e("q-item-section",[e("q-linear-progress",{attrs:{stripe:"",rounded:"",size:"30px",value:t.progress,color:"primary"}},[e("div",{staticClass:"absolute-full flex flex-center"},[e("q-badge",{attrs:{color:"white","text-color":"accent",label:t.progressLabel}})],1)])],1)],1):t._e()],!t.isGameEnd&&t.taskData.scoreReward?e("q-item",[e("q-item-section",[e("q-item-label",[t._v("積分商鋪：")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t.taskData.startTrt?e("q-btn",{staticClass:"q-px-xs",attrs:{dense:"",icon:"local_mall",flat:"",size:"15px",label:"開啟"},on:{click:function(e){return t.$emit("openScoreReward")}}}):t._e()],1)],1)],1):t._e(),!t.isGameEnd&&t.taskData.startTrt?e("q-item",[e("q-item-section",[e("q-item-label",[t._v(t._s(t.$t("prologue"))+"：")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t.taskData.startTrt?e("q-btn",{staticClass:"q-px-xs",attrs:{dense:"",icon:"movie",flat:"",size:"15px",label:t.$t("viewPrologue")},on:{click:function(e){return t.$emit("openViewTrt")}}}):t._e()],1)],1)],1):t._e(),e("q-item",[e("q-item-section",[e("q-item-label",[t._v(t._s(t.$t("replayGame"))+"：")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[e("q-btn",{staticClass:"q-px-xs",attrs:{flat:"",size:"15px",dense:"",icon:"restart_alt",label:t.$t("execReplayGame")},on:{click:function(e){return t.$emit("leaveTask")}}})],1)],1)],1)],2)],1),e("q-tab-panel",{attrs:{name:"desc"}},[e("div",{staticClass:"text-subtitle1 descContent",domProps:{innerHTML:t._s(t.gameDesc)}}),e("div",{staticClass:"text-center"},[e("q-btn",{attrs:{ripple:!1,size:"lg",round:"",color:"blue-8",flat:"",icon:"fa-brands fa-facebook"},on:{click:t.shareToFB}}),e("q-btn",{staticClass:"gradient-text",attrs:{ripple:!1,size:"lg",round:"",flat:"",icon:"fa-brands fa-threads"},on:{click:t.shareToThreads}}),e("q-btn",{attrs:{ripple:!1,size:"lg",round:"",color:"green",flat:"",icon:"fa-brands fa-line"},on:{click:t.shareToLine}}),e("q-btn",{attrs:{ripple:!1,size:"lg",round:"",flat:"",icon:"share",color:"red-8"},on:{click:t.share}})],1)]),e("q-tab-panel",{attrs:{name:"notes"}},[e("q-list",{attrs:{separator:"",bordered:""}},t._l(t.playNotes,function(a,s){return e("q-item",{key:s,staticClass:"bg-white",attrs:{clickable:""},on:{click:function(e){return t.openNotes(a)}}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{color:"teal",name:"auto_stories"}})],1),e("q-item-section",[e("q-item-label",{staticStyle:{"font-size":"18px"}},[e("div",[t._v("\n                "+t._s(a.msgTitle||t.$t("collectedNotes"))+"\n              ")])])],1)],1)}),1)],1),e("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"achv"}},[t.taskData.facetrackState?e("div",{staticClass:"q-pa-sm"},[e("q-btn",{staticClass:"full-width",attrs:{icon:"add_a_photo",label:t.$t("photoClearing"),color:"blue-grey-9",unelevated:""},on:{click:t.openfaceAR}})],1):t._e(),e("q-separator"),e("q-card-section",{staticClass:"q-pt-none"},[e("q-list",[e("q-item-label",{attrs:{header:""}},[t._v("通關資訊")]),e("q-item",{staticClass:"bg-white achieCard"},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{color:"blue-grey-9",name:"access_time_filled",size:"md"}})],1),e("q-item-section",[e("q-item-label",{staticClass:"achieTitle"},[t._v("\n                "+t._s(t.$t("timeToClear"))+"\n              ")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v(t._s(t.timeConsume))])],1)],1),e("q-separator",{attrs:{spaced:"",inset:"item"}}),e("q-item",{staticClass:"bg-white achieCard"},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{color:"blue-grey-9",name:"verified",size:"md"}})],1),e("q-item-section",[e("q-item-label",{staticClass:"achieTitle"},[t._v("\n                "+t._s(t.$t("clearingEnding"))+"\n              ")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[e("div",[t._v("\n                  "+t._s(t.gameEndInfo.endName)+"\n                ")])])],1)],1),t.gameEndInfo.score?e("q-item",{staticClass:"bg-white achieCard"},[e("q-item-section",[e("q-item-label",{staticClass:"achieTitle"},[t._v("\n                "+t._s(t.$t("totalPoints"))+"：\n              ")]),e("q-item-label",{attrs:{caption:""}},[t._v("\n                "+t._s(t.gameEndInfo.score)+" "+t._s(t.$t("score"))+"\n              ")])],1)],1):t._e()],1),t.useEvtErrReply.length>0?e("div",[e("q-separator",{attrs:{spaced:""}}),e("q-list",[e("q-item-label",{attrs:{header:""}},[t._v("數據統計")]),t._l(t.useEvtErrReply,function(a,s){return[0!==a.errReplyNum?e("q-item",{key:s,staticClass:"bg-white"},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{attrs:{rounded:"",color:"orange","text-color":"white",size:"28px"}},[t._v("\n                    "+t._s(s+1)+"\n                  ")])],1),e("q-item-section",[e("q-item-label",{staticClass:"ellipsis",staticStyle:{"font-size":"15px"}},[e("div",[t._v("\n                      "+t._s(a.evtName)+"\n                    ")])]),e("q-item-label",{attrs:{caption:""}},[t._v("\n                    "+t._s(t.$t("incoAnsNum"))+"： "+t._s(a.errReplyNum)+"\n                    "+t._s(t.$t("frequency"))+"\n                  ")])],1)],1):t._e(),s!==t.useEvtErrReply.length-1&&t.useEvtErrReply.length>1?e("q-separator",{key:"separator".concat(s),attrs:{spaced:"",inset:"item"}}):t._e()]})],2)],1):t._e(),e("q-separator",{attrs:{spaced:""}}),e("q-list",{attrs:{dense:""}},[e("q-item",[e("q-item-section",[e("div",{staticClass:"text-center"},[e("q-btn",{attrs:{ripple:!1,size:"lg",round:"",color:"blue-8",flat:"",icon:"fa-brands fa-facebook"},on:{click:t.shareToFB}}),e("q-btn",{staticClass:"gradient-text",attrs:{ripple:!1,size:"lg",round:"",flat:"",icon:"fa-brands fa-threads"},on:{click:t.shareToThreads}}),e("q-btn",{attrs:{ripple:!1,size:"lg",round:"",color:"green",flat:"",icon:"fa-brands fa-line"},on:{click:t.shareToLine}}),e("q-btn",{attrs:{ripple:!1,size:"16px",round:"",flat:"",icon:"share"},on:{click:t.share}})],1)])],1)],1),t.taskData.feedbackState?e("q-separator",{attrs:{spaced:""}}):t._e(),t.taskData.feedbackState?e("q-item",{staticClass:"bg-white achieCard",staticStyle:{"padding-right":"0px","padding-left":"0px"}},[e("q-item-section",[e("q-btn",{staticClass:"full-width q-py-xs",attrs:{icon:"edit",label:t.$t("writePlayFeedback"),color:"blue-grey-9",unelevated:""},on:{click:t.openPlayfeedback}})],1)],1):t._e()],1)],1)],1),e("q-dialog",{attrs:{persistent:"",maximized:"","transition-show":"fade","transition-hide":"fade"},model:{value:t.notesModel,callback:function(e){t.notesModel=e},expression:"notesModel"}},[e("q-card",{staticClass:"q-pa-xs"},[e("q-card-section",{staticClass:"q-pa-xs q-pb-sm row items-center"},[e("div",{staticClass:"text-dark text-center text-h5"},[e("div",[t._v("\n            "+t._s(t.notesContent.msgTitle||t.$t("collectedNotes"))+"\n          ")])]),e("q-space"),e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:t.closeNotes}})],1),e("q-separator"),e("section",[e("q-scroll-area",{staticStyle:{height:"calc(100vh - 60px)"}},[e("q-card-section",[e("div",[e("div",{domProps:{innerHTML:t._s(t.notesContent.htmlcontent)}})])])],1)],1)],1)],1),e("faceAR",{attrs:{prompt:t.poupSwch.faceAR,data:t.facetrackInfo},on:{close:t.closefaceAR}})],1)},m=[],b=(a("4de4"),a("910d"),function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{persistent:"","transition-show":"fade","transition-hide":"fade",maximized:""},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}},[e("q-card",{staticClass:"bg-grey-3 iframeCard"},[e("q-btn",{staticClass:"iframeCloseBtn",attrs:{round:"",dense:"",unelevated:"",color:"grey-9",icon:"close",size:"sm"},on:{click:t.close}}),e("q-card-section",{staticClass:"bg-white arMain"},[e("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"iframe",src:"".concat(t.iframeUrl,"/#/faceAR"),frameborder:"0",allow:"geolocation;camera *;microphone *",scrolling:"no"},on:{load:t.ifOnload}}),e("q-inner-loading",{attrs:{showing:t.isSendInfoToAr}},[e("q-spinner-gears",{attrs:{size:"50px",color:"primary"}}),e("div",{staticClass:"q-mt-sm text-primary"},[t._v(t._s(t.$t("realityModeLoading")))])],1)],1)],1)],1)}),g=[],w={props:["prompt","data"],name:"faceAR",data:function(){return{isSendInfoToAr:!0}},computed:{iframeUrl:function(){var t=location.hostname;return"localhost"==t?"http://localhost:7227":"https://rtraar.web.app"}},methods:{ifOnload:function(){this.isSendInfoToAr=!1;var t=document.getElementById("iframe").contentWindow;t.postMessage(this.data,this.iframeUrl)},close:function(){this.isSendInfoToAr=!0,this.$emit("close")}}},q=w,k=(a("ae4b"),a("2877")),v=a("24e8"),y=a("f09f"),S=a("9c40"),T=a("a370"),x=a("74f7"),C=a("cf57"),I=a("eebe"),$=a.n(I),E=Object(k["a"])(q,b,g,!1,null,"07539498",null),D=E.exports;$()(E,"components",{QDialog:v["a"],QCard:y["a"],QBtn:S["a"],QCardSection:T["a"],QInnerLoading:x["a"],QSpinnerGears:C["a"]});var R={name:"playStatus",components:{faceAR:D},props:["taskData","isGameEnd","gameEndInfo","facetrackInfo","score","planSpee","playNotes","playerStartTime"],data:function(){return{statusTab:this.checkIsGameEnd(),innerTab:"log",splitterModel:20,notesModel:!1,notesContent:{},poupSwch:{faceAR:!1},lang:this.$i18n.locale}},computed:d()(d()({},Object(p["c"])("designer/identity",["iden"])),{},{progressLabel:function(){var t="".concat(this.$t("missionProgress"),"：").concat(Math.round(100*this.progress)," %");return t},progress:function(){return this.planSpee?this.planSpee/100:0},timeConsume:function(t,e){var a=this.playerStartTime||0,s=this.gameEndInfo.finishTime||0,n=Math.round((s-a)/1e3);if(n<60)return"".concat(n," ").concat(this.$t("second"));var o=Math.floor(n/60),r=Math.floor(n%60);if(o<60)return"".concat(o," ").concat(this.$t("minute")," ").concat(r," ").concat(this.$t("second"));var i=Math.floor(o/60),c=Math.floor(o%60);return"".concat(i," ").concat(this.$t("hour")," ").concat(c," ").concat(this.$t("minute")," ").concat(r," ").concat(this.$t("second"))},gameDesc:function(){return this.taskData.taskDesc},useEvtErrReply:function(){if(!this.gameEndInfo.evtErrReply)return[];var t=this.gameEndInfo.evtErrReply.filter(function(t){return 0!==t.errReplyNum});return t},gameconfig:function(){return window.gameconfig}}),watch:{lang:function(t){localStorage.setItem("lang",t),this.$i18n.locale=t}},methods:{onLeft:function(t){var e=t.reset;setTimeout(function(){e()},3e3)},checkIsGameEnd:function(){return this.isGameEnd?"achv":"desc"},openNotes:function(t){this.notesContent=t,this.notesModel=!0},closeNotes:function(){this.notesModel=!1,this.notesContent={}},openfaceAR:function(){this.poupSwch.faceAR=!0},openPlayfeedback:function(){this.$emit("openPlayfeedback")},closefaceAR:function(){this.poupSwch.faceAR=!1},shareToThreads:function(){var t=encodeURIComponent(this.gameconfig.shareUrl),e=encodeURIComponent(this.gameconfig.shareText),a="https://www.threads.net/intent/post?text=".concat(e,"%20").concat(t);window.open(a,"_blank")},shareToFB:function(){var t=encodeURIComponent(this.gameconfig.shareUrl),e="https://www.facebook.com/sharer/sharer.php?u=".concat(t);window.open(e,"_blank")},shareToLine:function(){var t=encodeURIComponent(this.gameconfig.shareUrl),e=encodeURIComponent(this.gameconfig.shareText),a="https://line.me/R/msg/text/?".concat(e,"%20").concat(t);window.open(a,"_blank")},share:function(){navigator.share?navigator.share({title:document.title,text:this.gameconfig.shareText,url:this.gameconfig.shareUrl}).catch(function(t){return console.log("分享被取消或失敗:",t)}):alert("你的瀏覽器不支援 Web Share API")}}},P=R,M=(a("8153"),a("2b9f"),a("429b")),Q=a("7460"),N=a("eb85"),z=a("adad"),L=a("823b"),A=a("1c1c"),j=a("66e5"),B=a("4074"),O=a("0170"),U=a("6b1d"),G=a("58a81"),H=a("0016"),V=a("cb32"),W=a("2c91"),F=a("4983"),J=Object(k["a"])(P,h,m,!1,null,"eaa27a2c",null),K=J.exports;$()(J,"components",{QCard:y["a"],QTabs:M["a"],QTab:Q["a"],QSeparator:N["a"],QTabPanels:z["a"],QTabPanel:L["a"],QList:A["a"],QItem:j["a"],QItemSection:B["a"],QItemLabel:O["a"],QLinearProgress:U["a"],QBadge:G["a"],QBtn:S["a"],QIcon:H["a"],QCardSection:T["a"],QAvatar:V["a"],QDialog:v["a"],QSpace:W["a"],QScrollArea:F["a"]});var X=a("e4b9"),Y={name:"state",data:function(){return{taskData:{},score:0,finishTask:[],isGameEnd:!1,gameEndInfo:{},facetrackInfo:[],failMsgPayload:[],planSpee:0,playerStartTime:null,poupSwch:{isCanViewTrt:!1,scoreRewardModel:!1,playfeedback:!1},taskShow:!1,playNotes:[]}},components:{startTrtView:u["a"],playStatus:K},computed:d()(d()({},Object(p["c"])("playerMob/task",["info","task","event"])),{},{noReward:function(){if(!this.taskData.scoreReward)return!0;var t=0===Object.keys(this.taskData.scoreReward).length;return t},gameconfig:function(){return window.gameconfig}}),mixins:[X["a"]],methods:d()(d()(d()(d()(d()({},Object(p["b"])("playerMob/task",["setIsShowState","setIsShowTask","setIsShowProps"])),Object(p["b"])("playerMob/task",["setInfo","setTask","setEvent"])),Object(p["b"])("base/setting",["setShowLoadingMask"])),Object(p["b"])("playerMob/media",["setAMusicInfo"])),{},{resetTask:function(){var t=this;return c()(r()().m(function e(){var a;return r()().w(function(e){while(1)switch(e.n){case 0:return a={taskData:{},eventData:{},backpack:[],score:0,finishTask:[],isGameEnd:!1,gameEndInfo:{},facetrackInfo:[],failMsgPayload:[],planSpee:0,playerStartTime:(new Date).getTime(),playNotes:[]},e.n=1,alertConfirm(t.$t("confirmResetProgress"));case 1:if(!e.v){e.n=2;break}t.$q.loading.show({message:t.$t("dataResetting")}),t.taskShow=!1,t.setShowLoadingMask(!0),t.$q.localStorage.clear(),t.setInfo(),t.setTask(),t.setEvent(),t.taskData=t.task,t.score=0,t.finishTask=[],t.playNotes=[],t.isGameEnd=!1,t.planSpee=0,a.taskData=t.task,a.eventData=t.event,a.eventData.forEach(function(t){t.eventStory?t.needReadStory=!0:t.needReadStory=!1}),t.playerStartTime=a.playerStartTime,t.$q.localStorage.set("pzBase",a),t.taskShow=!0,t.setShowLoadingMask(!1),t.setIsShowProps(!1),t.setIsShowTask(!0),t.setIsShowState(!0),t.$q.loading.hide(),t.$q.notify({message:t.$t("missionReset"),position:"center",icon:"check_circle_outline",iconColor:"yellow",timeout:200}),t.$router.push({name:"task"});case 2:return e.a(2)}},e)}))()},playerBase:function(){var t=this;return c()(r()().m(function e(){var a;return r()().w(function(e){while(1)switch(e.n){case 0:a=t.$q.localStorage.getItem("pzBase"),a?t.useLocalData(a):(t.$q.localStorage.clear(),t.$router.push({name:"index"}));case 1:return e.a(2)}},e)}))()},useLocalData:function(t){var e=this;return c()(r()().m(function a(){var s;return r()().w(function(a){while(1)switch(a.n){case 0:e.$q.loading.show({message:e.$t("dataLoading")}),e.taskData=t.taskData||{},e.eventData=t.eventData||{},e.score=t.score||0,e.finishTask=t.finishTask||[],e.isGameEnd=t.isGameEnd||!1,e.gameEndInfo=t.gameEndInfo||{},e.facetrackInfo=t.facetrackInfo||[],e.failMsgPayload=t.failMsgPayload||[],e.planSpee=t.planSpee||0,e.playerStartTime=t.playerStartTime,e.playNotes=t.playNotes||[],e.taskShow=!0,e.setShowLoadingMask(!1),e.$q.loading.hide(),s=e.$route.params.isEnd,s&&e.taskData.feedbackState&&(e.poupSwch.playfeedback=!0),t.isGameEnd&&(e.setIsShowProps(!1),e.setIsShowTask(!1),e.setIsShowState(!1));case 1:return a.a(2)}},a)}))()},leaveTask:function(){var t=this;return c()(r()().m(function e(){return r()().w(function(e){while(1)switch(e.n){case 0:return e.n=1,alertConfirm(t.$t("confirmExitMission"),t.$t("removeProgress"));case 1:if(!e.v){e.n=2;break}t.$q.localStorage.clear(),t.setShowLoadingMask(!0),t.setAMusicInfo(null),t.setIsShowProps(!1),t.setIsShowTask(!0),t.setIsShowState(!0),t.$router.push({name:"index"});case 2:return e.a(2)}},e)}))()},closeModel:function(){this.poupSwch.isCanViewTrt=!1},openUserWeb:function(){this.taskData.projectUnit.link&&Object(f["a"])(this.taskData.projectUnit.link)},exchange:function(t){var e=this;return c()(r()().m(function a(){var s,n,o,i,c;return r()().w(function(a){while(1)switch(a.n){case 0:return s=t.rewardContent.propsLock?e.$t("unknownItem"):t.rewardName,n="".concat(s," / ").concat(t.rewardPrice," ").concat($t("points")),o=t.rewardContent,a.n=1,alertConfirm(e.$t("confirmRedeem"),n);case 1:if(!a.v){a.n=2;break}i=e.$q.localStorage.getItem("pzBase"),i=_.cloneDeep(e.getProps(o,i)),delete i.taskData.scoreReward[t.scoreRewardSN],e.taskData=_.cloneDeep(i.taskData),i.score-=t.rewardPrice,e.score-=t.rewardPrice,e.$q.localStorage.set("pzBase",i),c=o.propsLock?e.$t("unknownItem"):o.propsName,alertCF(e.$t("redeemSuccess"),"".concat(e.$t("itemObtained"),"【").concat(c,"】"),e.$t("viewItems"),e.$t("viewLater"),"success").then(function(t){t&&e.$router.push({name:"props"})});case 2:return a.a(2)}},a)}))()},openViewTrt:function(){this.taskData.startTrt&&(this.poupSwch.isCanViewTrt=!0)},goPlayfeedbackQues:function(){this.taskData.feedbackState&&(this.poupSwch.playfeedback=!1,Object(f["a"])(this.gameconfig.feedbackUrl))}}),mounted:function(){this.playerBase()}},Z=Y,tt=a("9989"),et=a("068f"),at=Object(k["a"])(Z,s,n,!1,null,"04b3da08",null);e["default"]=at.exports;$()(at,"components",{QPage:tt["a"],QCard:y["a"],QImg:et["a"],QList:A["a"],QItem:j["a"],QItemSection:B["a"],QAvatar:V["a"],QItemLabel:O["a"],QBadge:G["a"],QDialog:v["a"],QSpace:W["a"],QBtn:S["a"],QCardSection:T["a"],QSeparator:N["a"]})},"76cf":function(t,e,a){"use strict";a("7e05")},"7e05":function(t,e,a){},8153:function(t,e,a){"use strict";a("f748c")},a27d:function(t,e,a){},ae4b:function(t,e,a){"use strict";a("a27d")},e4b9:function(t,e,a){"use strict";var s=a("ded3"),n=a.n(s),o=(a("99af"),a("7db0"),a("14d9"),a("e9f5"),a("f665"),a("7d54"),a("cca6"),a("d3b7"),a("e6cf"),a("159b"),a("18d6"),a("2a19"),a("2f62"));e["a"]={methods:n()(n()({},Object(o["b"])("playerMob/task",["setIsShowProps"])),{},{getMap:function(){return new Promise(function(t,e){navigator.geolocation.getCurrentPosition(function(e){var a=e.coords,s=a.latitude,n=a.longitude,o="".concat(s,", ").concat(n);t(o)},function(t){},{enableHighAccuracy:!0})})},getProps:function(t,e){var a=e;if(t.propsLock)a.backpack.push(t);else{var s=a.backpack.find(function(e){return e.propsSN==t.propsSN});if(s){if(s){var n=Object.assign({},t,{quantity:s.quantity+1});a.backpack.forEach(function(t,e){t.propsSN==n.propsSN&&(a.backpack[e]=n)})}}else{var o=Object.assign({},t,{quantity:1});a.backpack.push(o)}1==t.inEffect&&a.finishTask.push(t.propsSN)}return localStorage.setItem("isShowProps",!0),this.setIsShowProps(!0),a},unlockNewEvt:function(t){}})}},e6c7:function(t,e,a){},f748c:function(t,e,a){},fd9b:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{persistent:"",maximized:"","transition-show":"fade","transition-hide":"fade"},on:{"before-show":t.openBg,hide:function(e){t.showStTrt=!1}},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}},[e("transition",{attrs:{name:"storyBg",mode:"out-in"}},[t.showStTrt?e("q-card",{staticClass:"startTrtWrap bg-dark",attrs:{flat:""}},[e("section",{staticClass:"startTrtArea full-width bg-white"},[[t.stTrtInfoPhoto?e("q-img",{attrs:{src:t.stTrtInfoPhoto,height:"250px"}}):t._e(),e("q-card-section",{staticClass:"startTrtIntro"},[e("q-scroll-area",{ref:"scrollArea",staticClass:"strtTyperText",style:t.deviceType,attrs:{"thumb-style":t.tubSty,"content-style":t.intorAreaSty2}},[t.storyTyper?e("div",[e("vue-typer",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{text:t.stTrtInfoText,repeat:0,shuffle:!1,"initial-action":"typing","pre-type-delay":500,"type-delay":"en-US"==t.$i18n.locale?10:25,"erase-on-complete":!1,"caret-animation":"smooth"},on:{completed:t.onComplete,"typed-char":t.onTyped}})],1):t._e(),e("div",{domProps:{textContent:t._s(t.startTrtInfo)}})]),e("div",{staticClass:"stTrtNextBtn"},[t.storyTyper?e("q-btn",{attrs:{round:"",unelevated:"",dense:"",color:"grey-3","text-color":"dark",ripple:!1},on:{click:t.showAllStory}},[e("q-spinner-dots",{attrs:{size:"24px"}})],1):t.storyTyper||t.storySlide===t.stTrtInfo.length-1?t.storyTyper||t.storySlide!=t.stTrtInfo.length-1?t._e():e("q-btn",{attrs:{flat:"",color:"orange-9",dense:"",icon:"task_alt",size:"16px",ripple:!1},on:{click:t.nextRoleStory}}):e("q-btn",{attrs:{round:"",unelevated:"",dense:"",color:"grey-3","text-color":"dark",icon:"arrow_forward",ripple:!1},on:{click:t.nextRoleStory}})],1)],1)]],2)]):t._e()],1),e("section",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},t._l(t.preloadImg,function(t,a){return e("img",{key:a,attrs:{src:t}})}),0)],1)},n=[],o=a("398e"),r=a.n(o),i=a("c973"),c=a.n(i),l=a("ded3"),d=a.n(l),p=(a("d81d"),a("e9f5"),a("7d54"),a("ab43"),a("d3b7"),a("e6cf"),a("ac1f"),a("5319"),a("159b"),a("2f62")),f=a("a403"),u={name:"startTrtView",props:["prompt","info"],data:function(){return{stTrtInfo:[],storySlide:0,storyTyper:!0,storyNext:!1,showStTrt:!1,deviceH:0,preloadImg:[],startTrtInfo:"",windowHeight:window.innerHeight}},computed:d()(d()(d()({},Object(p["c"])("base/setting",["tubSty","intorAreaSty2"])),Object(p["c"])("playerMob/task",["task"])),{},{stTrtText:function(){return"strtText"},stTrtInfoText:function(){var t=this.stTrtInfo[this.storySlide][this.stTrtText];return t?t.replace(/__NAME__/g,this.leadRoleName):null},stTrtInfoPhoto:function(){var t=this.stTrtInfo[this.storySlide].strtPhoto;return t||null},deviceType:function(){return this.deviceH>=850?{height:"".concat(this.viewportHeight-510,"px")}:{height:"".concat(this.viewportHeight-340,"px")}},leadRoleName:function(){var t=localStorage.getItem("useLeadRoleName");return t||this.$t("unnamedCharacter")},viewportHeight:function(){return this.windowHeight}}),methods:d()(d()({},Object(p["b"])("base/setting",["setShowLoadingMask"])),{},{nextRoleStory:function(){this.startTrtInfo="",this.storyTyper=!0,this.storyNext&&(this.storyNext=!1,this.storySlide==this.stTrtInfo.length-1?this.close():this.storySlide++)},showAllStory:function(){this.startTrtInfo=this.stTrtInfoText,this.storyTyper=!1,this.storyNext=!0},onComplete:function(){this.storyTyper=!1,this.storyNext=!0},close:function(){this.storySlide=0,this.storyTyper=!0,this.storyNext=!1,this.showStTrt=!1,this.startTrtInfo="",this.$emit("close")},updateWindowHeight:function(){this.windowHeight=window.innerHeight},openBg:function(){var t=this;return c()(r()().m(function e(){return r()().w(function(e){while(1)switch(e.n){case 0:return t.setShowLoadingMask(!0),t.$q.loading.show({spinner:f["a"],spinnerColor:"white",messageColor:"white",message:t.$t("prologueLoading"),delay:400}),e.n=1,t.setInfo();case 1:t.showStTrt=!0,t.$q.loading.hide(),setTimeout(function(){t.setShowLoadingMask(!1)},800);case 2:return e.a(2)}},e)}))()},setInfo:function(){var t=this;return c()(r()().m(function e(){var a;return r()().w(function(e){while(1)switch(e.n){case 0:if(a=t.$q.localStorage.getItem("pzBase").taskData.startTrt,!a){e.n=1;break}return t.stTrtInfo=_.cloneDeep(a),e.n=1,t.initImage();case 1:return e.a(2)}},e)}))()},onTyped:function(t){this.startTrtInfo+=t,this.$refs.scrollArea.setScrollPosition("vertical",200)},showPlatformInfo:function(){this.deviceH=this.$q.screen.height},initImage:function(){var t=this;return new Promise(function(e,a){var s=0;t.preloadImg=t.stTrtInfo.map(function(t){return t.strtPhoto}),t.preloadImg.forEach(function(a){var n=new Image;n.src=a,n.addEventListener("load",function(){s++,t.preloadImg.length===s&&e(!0)}),n.addEventListener("error",function(){s++,t.preloadImg.length===s&&e(!0)})})})}}),mounted:function(){this.showPlatformInfo(),window.addEventListener("resize",this.updateWindowHeight)},beforeDestroy:function(){window.removeEventListener("resize",this.updateWindowHeight)}},h=u,m=(a("76cf"),a("2877")),b=a("24e8"),g=a("f09f"),w=a("068f"),q=a("a370"),k=a("4983"),v=a("9c40"),y=a("8380"),S=a("eebe"),T=a.n(S),x=Object(m["a"])(h,s,n,!1,null,null,null);e["a"]=x.exports;T()(x,"components",{QDialog:b["a"],QCard:g["a"],QImg:w["a"],QCardSection:q["a"],QScrollArea:k["a"],QBtn:v["a"],QSpinnerDots:y["a"]})}}]);